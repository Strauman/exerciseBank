% This file contains the definition of the \isin macro
%:Â§ref
%:=\isin{haystack}{needle}{True}{False}
%: \meta{haystack} is a comma separated list of integers\\
%: \meta{needle} is an integer\\
%: Executes \meta{True} if \meta{needle} is found in \meta{haystack}
%: else executes \meta{False}
%:-
% #1: haystack
% #2: needle
% #3: action if found in list
% #4: action if not found in list
\gdef\isin#1#2#3#4{
  \def\needle{#2}
  \def\haystack{#1}
  \def\isFalse{0}
  \let\isInList = \isFalse
  \IfInteger{\haystack}{
    \if\haystack\needle
    #3
    \else
    #4
    \fi
  }{
  \foreach \pp in #1{
    \if\pp\needle
      \gdef\isInList{1}
      #3
    \fi
  }
  \if\isInList\isFalse
    #4
  \fi
  }
}
