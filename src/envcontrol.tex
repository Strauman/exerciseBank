%!TEX root = main.tex


\makeatletter

\global\let\DisplaySolution\DisplaySolutiontrue

\gdef\isFalse{0}
\gdef\isTrue{1}
\gdef\DisplayProblem{\isTrue}

%%%% NB: Difference between \DisplaySolution and \DisplaySolutions
\gdef\@DisplaySolutions{\isFalse}
\gdef\DisplaySolutions{\xdef\@DisplaySolutions{\isTrue}\@latex@warning{Showing solutions}}
\AtBeginDocument{
\if\@DisplaySolutions\isFalse
\@latex@warning{Hiding solutions. Show them with \string\DisplaySolutions}
\fi
}
\global\let\do@ProcessCutFile = \ProcessCutFile
%% Problems
\generalcomment{problem}{
  %%%% NB: Difference between \DisplaySolution and \DisplaySolutions
  \edef\DisplaySolution{\@DisplaySolutions}
  %% BeginPartproblemHard is before regardless whether
  %% the problem is included or not.
  \Trigger\DecideProblemDisplay
  \begingroup
    \if\DisplayProblem\isFalse
      \def\ProcessCutFile{}
    \else
      \Trigger\BeginPartproblem
    \fi
    }{
    \if\DisplayProblem\isFalse\else
      \Trigger\EndPartproblem
    \fi
  \endgroup
}
%% Solutions
\generalcomment{solution}
{
\Trigger\AtBeginSolutionHard
\begingroup
  \if\@DisplaySolutions\isTrue
    \if\DisplayProblem\isFalse
      \xdef\DisplaySolution{\isFalse}
    \fi
  \fi
  % \inspw{\DisplaySolution}
  \if\DisplaySolution\isTrue
    \Trigger\BeginSolution
  \else
    \def\ProcessCutFile{}
  % \begingroup
  % \edef\tmp{\def\noexpand\CommentCutFile{answer.tex}}
  % \tmp
    % \def\ProcessCutFile{\do@ProcessCutFile}
  \fi
}{
% \input{\CommentCutFile}
\if\DisplaySolution\isTrue
\Trigger\EndSolution
\fi

\Trigger\EndSolutionHard
\endgroup
}
%% Problem introductions
\newenvironment{intro}{}{}
